<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
     onclick="if (event.target === this) document.getElementById('modal-container').innerHTML = ''">
	<div class="bg-white dark:bg-gray-900 text-black dark:text-white rounded-lg shadow-lg max-w-md w-full p-6 relative space-y-6">
		<button class="absolute top-2 right-3 text-gray-500 hover:text-black dark:hover:text-white text-xl"
		        onclick="document.getElementById('modal-container').innerHTML = ''">&times;</button>

		<!-- Game name -->
		<h2 class="text-xl font-bold mb-3 text-center">{{ game.name }}</h2>

		<!-- Split section: 30% Icon / 70% Details -->
		<div class="grid grid-cols-10 gap-4 items-start">
			<!-- Left: Icon (30%) -->
			<div class="col-span-3 flex items-center justify-center">
				{% if game.icon %}
					<img src="{{ url_for('static', path='images/' ~ game.icon) }}"
					     alt="{{ game.name }} icon"
					     class="w-24 h-24 object-contain">
				{% else %}
					<span class="text-sm text-gray-400">No image</span>
				{% endif %}
			</div>

			<!-- Right: Details (70%) -->
			<div class="col-span-7 text-sm space-y-1">
				{% set status_color = {
					'working': 'text-green-700 dark:text-green-400',
					'needs_maintenance': 'text-yellow-700 dark:text-yellow-400',
					'out_of_order': 'text-red-700 dark:text-red-400'
				}[game.status.value] %}

				<p>
					<span class="text-gray-500 dark:text-gray-400">Category:</span>
					<span class="font-semibold text-gray-900 dark:text-gray-100">{{ game.category.name }}</span>
				</p>
				<p>
					<span class="text-gray-500 dark:text-gray-400">Status:</span>
					<span class="font-semibold {{ status_color }}">
						{{ game.status.value.replace('_',' ') | title }}
					</span>
				</p>
				{% if game.poc_name %}
				<p>
					<span class="text-gray-500 dark:text-gray-400">Contact:</span>
					<span class="font-semibold text-gray-900 dark:text-gray-100">{{ game.poc_name }}</span>
				</p>
				{% endif %}
				{% if game.poc_phone %}
				<p>
					<span class="text-gray-500 dark:text-gray-400">Phone:</span>
					<a href="tel:{{ game.poc_phone }}" target="_blank" rel="noopener noreferrer"
					   class="font-semibold text-blue-600 hover:underline dark:text-blue-400">
						{{ game.poc_phone }}
					</a>
				</p>
				{% endif %}
				{% if game.poc_email %}
				<p>
					<span class="text-gray-500 dark:text-gray-400">Email:</span>
					<a href="mailto:{{ game.poc_email }}" target="_blank" rel="noopener noreferrer"
					   class="font-semibold text-blue-600 hover:underline dark:text-blue-400 break-all">
						{{ game.poc_email }}
					</a>
				</p>
				{% endif %}
			</div>
		</div>

		<hr class="my-3 border-gray-200 dark:border-gray-700">

		<!-- UPDATE STATUS (2 columns) -->
		<div>
			<h3 class="text-sm font-semibold text-gray-600 dark:text-gray-200 uppercase mb-2">Update Status</h3>
			<div class="grid grid-cols-2 gap-2">
				<button
					hx-get="/game/{{ game.id }}/status-change-prompt?status=needs_maintenance"
					hx-target="#modal-container" hx-swap="innerHTML"
					class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded w-full">
					Needs Maintenance
				</button>

				<button
					hx-get="/game/{{ game.id }}/status-change-prompt?status=out_of_order"
					hx-target="#modal-container" hx-swap="innerHTML"
					class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded w-full">
					Is Broken
				</button>

				<button
					hx-get="/game/{{ game.id }}/status-change-prompt?status=working"
					hx-target="#modal-container" hx-swap="innerHTML"
					class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded w-full">
					Is Working
				</button>

				{% if request.session.logged_in %}
				<button
					hx-get="/game/{{ game.id }}/status-history"
					hx-target="#modal-container"
					hx-swap="innerHTML"
					class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded w-full">
					View Status History
				</button>
				{% endif %}
			</div>
		</div>

		<hr class="my-3 border-gray-200 dark:border-gray-700">

		<!-- LOG REVENUE (2 columns) -->
		<div>
			<h3 class="text-sm font-semibold text-gray-600 dark:text-gray-200 uppercase mb-2">Log Revenue</h3>
			<form
				hx-post="/game/{{ game.id }}/log-revenue"
				hx-target="#modal-container"
				hx-swap="innerHTML"
				class="space-y-2">
				<input type="hidden" name="user_id" value="{{ user.id }}">

				<!-- amount + type side by side -->
				<div class="grid grid-cols-2 gap-2">
					<input type="number" step="0.01" name="amount" placeholder="Amount" required
						class="border px-2 py-1 rounded dark:bg-gray-800 dark:border-gray-700">

					<select name="is_token" class="border px-2 py-1 rounded dark:bg-gray-800 dark:border-gray-700">
						<option value="false">Cash</option>
						<option value="true">Tokens</option>
					</select>
				</div>

				<!-- date selector full width -->
				<input name="collected_at" type="date"
					value="{{ datetime.utcnow().strftime('%Y-%m-%d') }}"
					class="w-full border px-2 py-1 rounded dark:bg-gray-800 dark:border-gray-700">


				<!-- log + history buttons side by side -->
				<div class="grid grid-cols-2 gap-2">
					<button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded w-full">
						Log Revenue
					</button>

					{% if request.session.is_manager %}
					<button
						hx-get="/game/{{ game.id }}/revenue-history"
						hx-target="#modal-container"
						hx-swap="innerHTML"
						class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded w-full">
						View History
					</button>
					{% endif %}
				</div>
			</form>
		</div>

		{% if user.role.value == 'admin' %}
		<hr class="my-3 border-gray-200 dark:border-gray-700">

		<!-- ADMIN ACTIONS (2 columns) -->
		<div>
			<h3 class="text-sm font-semibold text-gray-600 dark:text-gray-200 uppercase mb-2">Admin Actions</h3>
			<div class="grid grid-cols-2 gap-2">
				<button
					hx-get="/settings/games/{{ game.id }}/edit"
					hx-target="#modal-container"
					hx-swap="innerHTML"
					class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded w-full inline-flex items-center justify-center">
					<i class="fa-solid fa-pencil mr-2"></i>
					<span>Edit Game</span>
				</button>

				<!-- Delete Game (confirm + DELETE) -->
				<button
					hx-delete="/settings/games/{{ game.id }}/delete"
					hx-target="#modal-container"
					hx-swap="innerHTML"
					hx-confirm="Delete '{{ game.name }}'? This cannot be undone."
					class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded w-full inline-flex items-center justify-center">
					<i class="fa-solid fa-trash mr-2"></i>
					<span>Delete Game</span>
				</button>
			</div>
		</div>
		{% endif %}

	</div>
</div>
